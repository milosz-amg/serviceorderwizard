<mvc:View
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    controllerName="com.mr.serviceorderwizard.controller.CreateOrder"
    xmlns:core="sap.ui.core"
    xmlns:form="sap.ui.layout.form"
    height="100%"
>
    <NavContainer id="wizardNavContainer">
        <pages>
            <Page
                id="wizardContentPage"
                showHeader="false"
            >
                <content>
                    <Wizard
                        id="createOrderWizard"
                        complete="wizardCompletedHandler"
                    >
                        <WizardStep
                            id="stepPersonalData"
                            title="{i18n>stepPersonalDataTitle}"
                            validated="false"
                        >
                            <MessageStrip
                                id="wizardInfoMessage"
                                class="sapUiSmallMarginBottom"
                                text="{i18n>rodoBanner}"
                                showIcon="true"
                            />

                            <Text text="{i18n>rodoText}" />

                            <form:SimpleForm
                                editable="true"
                                layout="ResponsiveGridLayout"
                                title="{i18n>stepPersonalDataTitle}"
                            >
                                <Label
                                    id="firstNameLabel"
                                    text="{i18n>firstNameLabel}"
                                    labelFor="firstNameInput"
                                />
                                <Input
                                    id="firstNameInput"
                                    placeholder="{i18n>firstNamePlaceholder}"
                                    required="true"
                                    change="validatePersonalDataName"
                                    valueState="None"
                                    value="{orderData>/personalData/firstName}"
                                />

                                <Label
                                    id="lastNameLabel"
                                    text="{i18n>lastNameLabel}"
                                    labelFor="lastNameInput"
                                />
                                <Input
                                    id="lastNameInput"
                                    placeholder="{i18n>lastNamePlaceholder}"
                                    required="true"
                                    change="validatePersonalDataLastName"
                                    valueState="None"
                                    value="{orderData>/personalData/lastName}"
                                />

                                <Label
                                    id="phoneNumberLabel"
                                    text="{i18n>phoneNumberLabel}"
                                    labelFor="phoneNumberInput"
                                />
                                <Input
                                    id="phoneNumberInput"
                                    placeholder="{i18n>phoneNumberPlaceholder}"
                                    required="true"
                                    change="validatePersonalDataPhoneNumber"
                                    valueState="None"
                                    value="{orderData>/personalData/phoneNumber}"
                                />

                                <Label
                                    id="addressFirstLineLabel"
                                    text="{i18n>addressFirstLineLabel}"
                                    labelFor="addressFirstLineInput"
                                />
                                <Input
                                    id="addressFirstLineInput"
                                    placeholder="{i18n>addressFirstLinePlaceholder}"
                                    valueState="None"
                                    value="{orderData>/personalData/addressFirstLine}"
                                />

                                <Label
                                    id="addressSecondLineLabel"
                                    text="{i18n>addressSecondLineLabel}"
                                    labelFor="addressSecondLineInput"
                                />
                                <Input
                                    id="addressSecondLineInput"
                                    placeholder="{i18n>addressSecondLinePlaceholder}"
                                    valueState="None"
                                    value="{orderData>/personalData/addressSecondLine}"
                                />

                                <Label
                                    id="addressZipCodeLabel"
                                    text="{i18n>zipCodeLabel}"
                                    required="true"
                                    labelFor="addressZipCodeInput"
                                />
                                <Input
                                    id="addressZipCodeInput"
                                    placeholder="{i18n>zipCodePlaceholder}"
                                    change="validatePersonalDataZipCode"
                                    valueState="None"
                                    value="{orderData>/personalData/addressZipCode}"
                                />

                                <Label
                                    id="addressCityLabel"
                                    text="{i18n>cityLabel}"
                                    required="true"
                                    labelFor="addressCityInput"
                                />
                                <Input
                                    id="addressCityInput"
                                    placeholder="{i18n>cityPlaceholder}"
                                    required="true"
                                    change="validatePersonalDataCity"
                                    valueState="None"
                                    value="{orderData>/personalData/addressCity}"
                                />
                            </form:SimpleForm>
                            <Button
                                id="validatePersonalButton"
                                text="{i18n>validateDataButton}"
                                press="validatePersonalData"
                            />
                        </WizardStep>

                        <WizardStep
                            id="stepFaultDesc"
                            title="{i18n>stepFaultDescTitle}"
                            validated="false"
                        >
                            <MessageStrip
                                class="sapUiSmallMarginBottom"
                                text="{i18n>deviceFaultHelpMessage}"
                                showIcon="true"
                            />
                            <form:SimpleForm
                                editable="true"
                                layout="ResponsiveGridLayout"
                                title="{i18n>deviceInfoFormTitle}"
                            >
                                <Label
                                    id="deviceTypeLabel"
                                    text="{i18n>deviceTypeLabel}"
                                    required="true"
                                    labelFor="deviceTypeComboBox"
                                />
                                <ComboBox
                                    width="100%"
                                    id="deviceTypeComboBox"
                                    required="true"
                                    placeholder="{i18n>deviceTypePlaceholder}"
                                    change="onDeviceTypeChange"
                                    valueState="None"
                                    selectedKey="{orderData>/deviceData/deviceTypeKey}"
                                    value="{orderData>/deviceData/deviceType}"
                                    items="{deviceTypes>/}"
                                >
                                    <core:Item
                                        key="{deviceTypes>Id}"
                                        text="{deviceTypes>Name}"
                                    />
                                </ComboBox>

                                <Label
                                    text="{i18n>deviceModelLabel}"
                                    required="true"
                                />
                                <ComboBox
                                    id="deviceModelInput"
                                    placeholder="{i18n>deviceModelPlaceholder}"
                                    required="true"
                                    change="validateFaultDescDeviceModel"
                                    selectedKey="{orderData>/deviceData/deviceModelKey}"
                                    value="{orderData>/deviceData/deviceModel}"
                                    valueState="None"
                                />

                                <Label
                                    id="deviceSerialNumberLabel"
                                    text="{i18n>deviceSerialNumberLabel}"
                                    labelFor="deviceSerialNumberInput"
                                />
                                <Input
                                    id="deviceSerialNumberInput"
                                    placeholder="{i18n>deviceSerialNumberPlaceholder}"
                                    valueState="None"
                                    value="{orderData>/deviceData/deviceSerialNumber}"
                                />

                                <Label
                                    id="faultDescLabel"
                                    text="{i18n>faultDescriptionLabel}"
                                    labelFor="faultDescInput"
                                />
                                <TextArea
                                    width="100%"
                                    id="faultDescInput"
                                    placeholder="{i18n>faultDescriptionPlaceholder}"
                                    rows="8"
                                    valueState="None"
                                    value="{orderData>/deviceData/faultDescription}"
                                />
                            </form:SimpleForm>
                            <Button
                                id="validateDeviceButton"
                                text="{i18n>validateDataButton}"
                                press="validateFaultDesc"
                            />
                        </WizardStep>
                        <WizardStep
                            id="stepVisitDate"
                            title="{i18n>stepVisitDateTitle}"
                            validated="false"
                        >
                            <form:SimpleForm
                                editable="true"
                                layout="ResponsiveGridLayout"
                                title="{i18n>visitTermFormTitle}"
                            >
                                <Label
                                    id="visitDateLabel"
                                    text="{i18n>visitDateLabel}"
                                    labelFor="visitDateInput"
                                />
                                <DatePicker
                                    id="visitDateInput"
                                    placeholder="{i18n>visitDatePlaceholder}"
                                    required="true"
                                    change="validateVisitDateDate"
                                    valueState="None"
                                    value="{orderData>/visitData/visitDate, UTC: true }"
                                />

                                <Label
                                    id="visitTimeLabel"
                                    text="{i18n>visitTimeLabel}"
                                    labelFor="visitHourSelect"
                                />
                                <Select
                                    id="visitHourSelect"
                                    required="true"
                                    change="validateVisitDateHour"
                                    valueState="None"
                                    selectedKey="{orderData>/visitData/visitTimeKey}"
                                >
                                    <core:Item
                                        key=""
                                        text=""
                                    />
                                    <core:Item
                                        key="08"
                                        text="{i18n>timeSlot08}"
                                    />
                                    <core:Item
                                        key="09"
                                        text="{i18n>timeSlot09}"
                                    />
                                    <core:Item
                                        key="10"
                                        text="{i18n>timeSlot10}"
                                    />
                                    <core:Item
                                        key="11"
                                        text="{i18n>timeSlot11}"
                                    />
                                    <core:Item
                                        key="12"
                                        text="{i18n>timeSlot12}"
                                    />
                                    <core:Item
                                        key="13"
                                        text="{i18n>timeSlot13}"
                                    />
                                    <core:Item
                                        key="14"
                                        text="{i18n>timeSlot14}"
                                    />
                                    <core:Item
                                        key="15"
                                        text="{i18n>timeSlot15}"
                                    />
                                    <core:Item
                                        key="16"
                                        text="{i18n>timeSlot16}"
                                    />
                                </Select>
                            </form:SimpleForm>
                            <Button
                                id="validateVisitButton"
                                text="{i18n>validateDataButton}"
                                press="validateVisitDate"
                            />
                        </WizardStep>
                        <WizardStep
                            id="stepSummary"
                            title="{i18n>stepSummaryTitle}"
                            validated="true"
                        >
                            <MessageStrip
                                class="sapUiSmallMarginBottom"
                                text="{i18n>summaryHelpMessage}"
                                showIcon="true"
                            />
                            <Button
                                id="submitOrderButton"
                                text="{i18n>generateOrderButton}"
                                press="onSubmitOrder"
                            />
                        </WizardStep>
                    </Wizard>
                </content>
                <footer>
                    <OverflowToolbar>
                        <ToolbarSpacer />
                        <Button
                            text="{i18n>cancelButton}"
                            press="handleWizardCancel"
                        />
                    </OverflowToolbar>
                </footer>
            </Page>

            <Page
                id="wizardReviewPage"
                showHeader="false"
            >
                <content>
                    <form:SimpleForm
                        title="{i18n>summaryPersonalDataTitle}"
                        editable="false"
                        layout="ResponsiveGridLayout"
                    >
                        <form:content>
                            <Label text="{i18n>summaryFirstName}" />
                            <Text
                                id="FirstNameChosen"
                                text="{orderData>/personalData/firstName}"
                            />
                            <Label text="{i18n>summaryLastName}" />
                            <Text
                                id="LastNameChosen"
                                text="{orderData>/personalData/lastName}"
                            />
                            <Label text="{i18n>summaryPhone}" />
                            <Text
                                id="PhoneNumberChosen"
                                text="{orderData>/personalData/phoneNumber}"
                            />
                            <Label text="{i18n>summaryAddress}" />
                            <Text
                                id="AddressChosen"
                                text="{
                                    parts: [
                                        'orderData>/personalData/addressFirstLine',
                                        'orderData>/personalData/addressSecondLine',
                                        'orderData>/personalData/addressZipCode',
                                        'orderData>/personalData/addressCity'
                                    ],
                                    formatter: '.formatter.formatAddress'
                                }"
                            />
                            <Link
                                press="editStepOne"
                                text="{i18n>editButton}"
                            />
                        </form:content>
                    </form:SimpleForm>

                    <form:SimpleForm
                        title="{i18n>summaryDeviceInfoTitle}"
                        editable="false"
                        layout="ResponsiveGridLayout"
                    >
                        <form:content>
                            <Label text="{i18n>summaryDeviceType}" />
                            <Text
                                id="DeviceTypeChosen"
                                text="{orderData>/deviceData/deviceType}"
                            />
                            <Label text="{i18n>summaryDeviceModel}" />
                            <Text
                                id="DeviceModelChosen"
                                text="{orderData>/deviceData/deviceModel}"
                            />
                            <Label text="{i18n>summaryDeviceSerial}" />
                            <Text
                                id="DeviceSerialChosen"
                                text="{orderData>/deviceData/deviceSerialNumber}"
                            />
                            <Label text="{i18n>summaryFaultDescription}" />
                            <Text
                                id="FaultDescriptionChosen"
                                text="{orderData>/deviceData/faultDescription}"
                            />
                            <Link
                                press="editStepTwo"
                                text="{i18n>editButton}"
                            />
                        </form:content>
                    </form:SimpleForm>

                    <form:SimpleForm
                        title="{i18n>summaryVisitTermTitle}"
                        editable="false"
                        layout="ResponsiveGridLayout"
                    >
                        <form:content>
                            <Label text="{i18n>summaryVisitDate}" />
                            <Text
                                id="VisitDateChosen"
                                text="{path: 'orderData>/visitData/visitDate', formatter: '.formatter.formatDate'}"
                            />
                            <Label text="{i18n>summaryVisitTime}" />
                            <Text
                                id="VisitTimeChosen"
                                text="{orderData>/visitData/visitTime}"
                            />
                            <Link
                                press="editStepThree"
                                text="{i18n>editButton}"
                            />
                        </form:content>
                    </form:SimpleForm>
                </content>
                <footer>
                    <Bar>
                        <contentRight>
                            <Button
                                text="{i18n>sendButton}"
                                press="handleWizardSubmit"
                            />
                            <Button
                                text="{i18n>cancelButton}"
                                press="handleWizardCancel"
                            />
                        </contentRight>
                    </Bar>
                </footer>
            </Page>
        </pages>
    </NavContainer>
</mvc:View>
