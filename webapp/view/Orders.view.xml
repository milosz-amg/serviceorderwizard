<mvc:View
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:table="sap.ui.table"
    controllerName="com.mr.serviceorderwizard.controller.Orders"
>
    <Page
        id="ordersPage"
        title="{i18n>ordersPageTitle}"
    >
        <content>
            <VBox
                id="mainBox"
                width="100%"
                class="sapUiMediumMargin"
            >
                <!-- Header with buttons -->
                <HBox
                    id="headerBox"
                    justifyContent="SpaceBetween"
                    alignItems="Center"
                    class="sapUiSmallMarginBottom"
                >
                    <Title
                        id="ordersTitle"
                        text="{i18n>ordersListTitle}"
                        level="H2"
                    />
                    <HBox
                        id="buttonBox"
                        class="sapUiMediumMarginEnd"
                    >
                        <Button
                            id="refreshButton"
                            text="{i18n>refreshButton}"
                            press="onRefresh"
                            icon="sap-icon://refresh"
                            type="Emphasized"
                            class="sapUiTinyMarginEnd"
                        />
                    </HBox>
                </HBox>

                <!-- Status message -->
                <MessageStrip
                    id="statusMessage"
                    text="{viewModel>/statusMessage}"
                    type="{viewModel>/messageType}"
                    visible="{viewModel>/showMessage}"
                    class="sapUiSmallMarginBottom"
                />

                <!-- Table view -->
                <table:Table
                    id="ordersTable"
                    rows="{orders>/}"
                    width="100%"
                    selectionMode="None"
                    enableCellFilter="true"
                    enableColumnReordering="false"
                    enableSelectAll="false"
                    columnHeaderHeight="36"
                    class="sapUiSizeCompact ordersTableHeight"
                >
                    <table:extension>
                        <OverflowToolbar id="tableToolbar">
                            <content>
                                <Title
                                    id="tableTitle"
                                    text="{= ${i18n>ordersTableTitle} + ' (' + ${viewModel>/ordersCount} + ')' }"
                                />
                            </content>
                        </OverflowToolbar>
                    </table:extension>

                    <table:columns>
                        <!-- ID column (narrow) -->
                        <table:Column id="col1" width="10%" filterProperty="OrderId">
                            <Label
                                id="header1"
                                text="{i18n>ordersColId}"
                            />
                            <table:template>
                                <Text
                                    text="{
                                        path: 'orders>OrderId',
                                        formatter: '.formatter.formatOrderId'
                                    }"
                                />
                            </table:template>
                        </table:Column>

                        <!-- Order creation date (narrow) -->
                        <table:Column id="colCreated" width="15%">
                            <Label
                                id="headerCreated"
                                text="{i18n>ordersColCreatedDate}"
                            />
                            <table:template>
                                <Text
                                    text="{
                                        path: 'orders>OrderCreationDate',
                                        formatter: '.formatter.formatDate'
                                    }"
                                />
                            </table:template>
                        </table:Column>

                        <!-- Visit date (narrow) -->
                        <table:Column id="col7" width="15%">
                            <Label
                                id="header7"
                                text="{i18n>ordersColVisitDate}"
                            />
                            <table:template>
                                <Text
                                    text="{
                                        path: 'orders>Visitdate',
                                        formatter: '.formatter.formatDate'
                                    }"
                                />
                            </table:template>
                        </table:Column>

                        <!-- City (flexible) -->
                        <table:Column id="col4" width="25%" filterProperty="Addresscity" defaultFilterOperator="Contains">
                            <Label
                                id="header4"
                                text="{i18n>ordersColCity}"
                            />
                            <table:template>
                                <Text
                                    text="{orders>Addresscity}"
                                />
                            </table:template>
                        </table:Column>

                        <!-- Status (narrow) -->
                        <table:Column id="col8" width="15%" filterProperty="Status" defaultFilterOperator="EQ">
                            <Label
                                id="header8"
                                text="{i18n>ordersColStatus}"
                            />
                            <table:template>
                                <Text
                                    text="{orders>Status}"
                                />
                            </table:template>
                        </table:Column>

                        <table:Column id="colDetails" width="10%">
                            <Label
                                id="headerDetails"
                                text="{i18n>ordersColDetails}"
                            />
                            <table:template>
                                <Button
                                    text="{i18n>detailsButton}"
                                    icon="sap-icon://detail-view"
                                    press="onShowDetails"
                                    type="Transparent"
                                />
                            </table:template>
                        </table:Column>

                        <table:Column id="colDelete" width="10%">
                            <Label
                                id="headerDelete"
                                text="{i18n>ordersColActions}"
                            />
                            <table:template>
                                <Button
                                    text="{i18n>deleteButton}"
                                    icon="sap-icon://delete"
                                    type="Reject"
                                    press="onDeleteOrder"
                                />
                            </table:template>
                        </table:Column>
                    </table:columns>
                </table:Table>
            </VBox>
        </content>
    </Page>
</mvc:View>
